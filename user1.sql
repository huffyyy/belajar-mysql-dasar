START TRANSACTION;

SELECT *
FROM guestbook;

UPDATE guestbook
SET title = 'Diubah Oleh User1'
WHERE id = 9;

COMMIT;

START TRANSACTION;

SELECT *
FROM products;

SELECT *
FROM products
WHERE id = 'P001' FOR
UPDATE;

UPDATE products
SET quantity = quantity - 10
WHERE id = 'P001';

COMMIT;

#DEADLOCk

START TRANSACTION;

SELECT *
FROM products
WHERE id = 'P001' FOR
UPDATE;

SELECT *
FROM products
WHERE id = 'P002' FOR
UPDATE;

#LOCK TABLE READ

LOCK TABLES products READ ;

UPDATE products
SET quantity = 100
WHERE id = 'P001';

UNLOCK TABLES ;

#LOCK TABLE WRITE

LOCK TABLES products WRITE ;

UPDATE products
SET quantity = 100
WHERE id = 'P001';

SELECT * FROM products;

#LOCK INSTANCE

LOCK INSTANCE FOR BACKUP;

UNLOCK INSTANCE;